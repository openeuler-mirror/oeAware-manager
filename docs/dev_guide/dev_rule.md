# oeAware 开发规范
- 本文档可作为新开发者开发代码需要遵守的基本规则。
- 检视人检视PR时可直接通过编号约束开发者修改代码。
- 对开发常见开发错误可补充至此文档作为后续开发规范。
## 1. PR规范
1-1. 提交前确保代码已通过单元测试和集成测试。<br>
1-2. 提交信息清晰、简洁，遵循约定式提交规范（如：feat: 新增功能，fix: 修复缺陷）。<br>
1-3. PR描述应包含本次变更的目的、内容、影响以及如何测试。<br>
1-4. PR描述和commit信息一致，且commit不许包含中文，否则生成的patch会丢失内容。<br>
1-5. 至少需要一名团队成员进行代码审查并批准。<br>
1-6. 关联相关的任务或缺陷跟踪issue。<br>

## 2. 代码风格
2-1. 遵循 C++11 标准，推荐使用现代C++特性（如智能指针、auto等）。oeAware 需要在多版本运行，请确保在最低版本(openEuler 2003, gcc 7.3.0/C++14) 下能正常编译<br>
2-2. 变量、函数、类命名采用小驼峰（camelCase）或大驼峰（PascalCase），避免使用拼音。<br>
2-3. 常量使用全大写字母加下划线分隔（如：MAX_SIZE）。<br>
2-4. 缩进统一使用4个空格。<br>
2-5. 每行代码不超过120字符，必要时换行。<br>
2-6. 头文件保护。<br>

## 3. 文件与目录结构
3-1. 插件源码放在 `src/plugin/` 下，按功能模块分子目录。<br>
3-2. 公共头文件放在 `include/oeaware/` 下，数据接口头文件放在 `include/oeaware/data/`。<br>
3-3. 文档放在 `docs/` 目录，开发文档在 `docs/dev_guide/`。<br>

## 4. 插件开发规范
4-1. 插件必须实现 `Interface` 接口。<br>
4-2. 插件实例命名需简洁明了，避免歧义。<br>
4-3. 插件需通过 `GetInstance` 方法注册所有实例。<br>
4-4. 每个实例需注册其支持的Topic，必要时实现数据订阅与发布。<br>
4-5. 禁止在插件中直接操作全局资源，需通过接口或依赖注入方式访问。<br>
4-6. 插件如果使能后修改了系统参数，请在插件退出时恢复。<br>
4-7. oeAware在openEuler上多个版本发布，且大部分在BASE仓库发布，属于基础底层软件，尽量不要引入新的依赖 <br>
4-8. 如果必须添加新的依赖项，考虑依赖项的适用性，如果仅在单个插件中使用，考虑采用弱依赖，即要求客户手动安装此依赖，oeAaware的spec文件中不添加该依赖，而是插件运行时提示缺少依赖，要求用户手动安装。

## 5. 错误处理与日志
5-1. 所有接口返回值需检查，错误需及时处理并输出日志。<br>
5-2. 日志使用框架提供的日志接口，禁止直接使用 `printf`、`std::cout`。<br>
5-3. 日志信息需包含关键信息，便于定位问题。<br>

## 6. 资源管理
6-1. 禁止内存泄漏，推荐使用智能指针（如 `std::shared_ptr`、`std::unique_ptr`）。<br>
6-2. 文件、句柄等资源需及时关闭和释放。<br>
6-3. 禁止死锁、资源竞争等并发问题。<br>

## 7. 接口与数据结构
7-1. 所有对外接口和数据结构需有完整注释，说明用途和参数含义。<br>
7-2. 新增数据接口需放在 `include/oeaware/data/`，并补充文档说明。<br>

## 8. 编译与测试
8-1. 插件需通过CMake集成，编译无警告（-Wall -Wextra）。<br>
8-2. 必须编写单元测试，测试代码放在 `tests/` 目录。<br>
8-3. 重要功能需有集成测试用例。<br>

## 9. 文档要求
9-1. 每个插件需有独立的开发说明文档，内容包括功能、接口、使用方法、依赖等。<br>
9-2. 重要变更需在 `CHANGELOG.md` 记录。<br>
9-3. 代码需有必要的注释，复杂逻辑需详细说明。<br>

## 10. 其他约定
10-1. 禁止引入未经许可的第三方库。<br>
10-2. 严禁提交敏感信息（如密码、密钥等）到代码库。<br>
10-3. 遵守开源社区贡献规范。<br>

## 11. Issue管理
11-1. 重要修改需提issue跟踪。<br>
11-2. 在issue中详细介绍修改原理。<br>
11-3. 关联相关的PR和代码变更。<br>

如有疑问，请联系维护者。<br>